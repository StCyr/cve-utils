# Filename of our SQLite CPE dictionary
our $cpe_dictionary='cpe_dict.db';

# Where to find the official NIST CPE dictionary in XML format (you can download it from https://nvd.nist.gov/cpe.cfm)
our $official_cpe_dictionary='official-cpe-dictionary_v2.3.xml';

#################################################
#
# Regular expressions start here
#
#################################################

# Hash of known vendors
our %vendor_match = (
  '7-zip' => '7-zip',
  'adobe_' => 'adobe',
  'analog_devices' => 'analog',
  'apache_software_foundation' => 'apache',
  'apple.+?inc' => 'apple',
  'avocent_corporation' => 'avocent',
  'bare_bones_software' => 'barebones',
  'brother_industries' => 'brother',
  'canon_inc' => 'canon',
  'cace_technologies' => 'winpcap',
  'cisco_systems' => 'cisco',
  'citrix_systems' => 'citrix',
  'corel_corp' => 'corel',
  'claws-mail.org' => 'claws-mail',
  'cutepdf_writer' => 'acrosoftware',
  'cyberlink' => 'cyberlink',
  'dell_inc' => 'dell',
  'disc_soft_ltd' => 'daemontools',
  'dotpdn_llc' => 'dotpdn',
  'dominik_reichl' => 'keepass',
  'dropbox' => 'dropbox',
  'evernote' => 'evernote',
  'firebird' => 'firebird',
  'the_gimp_team' => 'gimp',
  'google' => 'google',
  'hewlett[-_]packard' => 'hp',
  'hp_development_company' => 'hp',
  'intel_corporation' => 'intel',
  'inkscape' => 'inkscape',
  'irfan_skiljan' => 'irfanview',
  'juniper_networks' => 'juniper',
  '^kresimir_petric' => 'freesshd',
  'lexmark_international' => 'lexmark',
  'mcafee,_inc.' => 'mcafee',
  'malwarebytes_corporation' => 'malwarebytes',
  'martin_prikryl' => 'winscp',
  'microsoft_corporation' => 'microsoft',
  'mysql_ab' => 'mysql',
  'openoffice.org' => 'apache',
  'openoffice.org' => 'sun',
  'nmap_' => 'nmap',
  'nvidia_corporation' => 'nvidia',
  'notepad\+\+' => 'notepad_plus_plus',
  'nullsoft' => 'nullsoft',
  '^nitro' => 'nitropdf',
  'ocs_+inventory' => 'ocsinventory-ng',
  '^ocsng$' => 'ocsinventory-ng',
  'oracle_corporation' => 'oracle',
  'openssh-' => 'openbsd',
  '^postgresql_global' => 'postgresql',
  'python_software_foundation' => 'python',
  'sanford,_l.p.' => 'dymo',
  'safer-networking_ltd.' => 'safer-networking',
  'samsung_electronics' => 'samsung',
  '^security_innovation' => 'securityinnovation',
  'silksvn' => 'silksvn',
  'sun_microsystems' => 'sun',
  'skype' => 'skype',
  'symantec_corporation' => 'symantec',
  '^stmicroelectronics' => 'st',
  'teamviewer' => 'teamviewer',
  'the_videolan_team' => 'videolan',
  'the_wireshark_developer_community' => 'wireshark',
  'tortoisesvn' => 'tigris',
  'tracker_software' => 'tracker-software',
  'trimble_navigation_limited' => 'trimble',
  'vmware' => 'vmware',
  'wave_systems_corp' => 'wave',
  'win.rar_gmbh' => 'rarlab',
  '^winzip_computing' => 'winzip',
);

# Hash of known products
our %product_match = (
  'nitro_pdf_professional' => 'nitro_pdf',
  'nitro_pro' => 'nitro_pdf',
  'ocs_inventory_ng_agent' => 'ocsinventory_ng',
  '^ocsng$' => 'ocsinventory_ng',
  '^quicktime_player$' => 'quicktime',
  '^adobe_reader_x' => 'acrobat_reader',
  '^vlc$' => 'vlc_media_player',
);

# list of products to skip (eg. MS updates, hotfix,...)
our @products2skip = (
  'update_for_microsoft',
  'update_kb',
  'hotfix_kb',
  'update_for_windows',
  'correctif_pour',
  'mise____jour_de_s__curit___',
  'mise____jour_pour_',
);

# list of frequent leading vendor name in product names
our @product_leading_vendor = (
  'apple_',
  'adobe_',
  'amazon_',
  'brother_',
  'cisco_',
  'dell_',
  'intel_+',
  'intel\(r\)_',
  'google_*',
  'hp_',
  'juniper_networks_',
  'logitech_',
  'malwarebytes_',
  'microsoft_',
  'mozilla_',
  'nvidia_',
  'oracle_',
  'roxio_',
  'symantec_',
  'vmware_',
  'windows_',
);

our @product_trailing_crap = (
  '^(.*?)_+(\(remove_only\))$',
  '^(.*?)_+(\(remove_or_repair\))$',
  '^(.*?)_+(\(uninstall_only\))$',
);

# List of regex to try and match version number in product names
our @version_regex = (
  '^(.*?)_+([\d\.]*)$',
  '^(.*?)_+v\.+([\d\.]*)$',
  '^(.*?)_+v\._([\d\.]*)$',
  '^(.*?)_+version_([\d\.]*)$',
  '^(.*?)_+\(([\d\.]*)\)$',
  '^(.*?)_+([\d\.]*)_\(win32\)$',
  '^(.*?)_+([\d\.]*)_\(32[-_]bit\)$',
  '^(.*?)_+([\d\.]*)_\(64[-_]bit\)$',
  '^(.*?)_+([\d\.]*)_\(x86(_[a-z\-A-Z]*)+\)$',
  '^(.*?)_+([\d\.]*)_\(x64(_[a-z\-A-Z]*)+\)$',
  '^(.*?)_+([\d]*_update_[\d]*)$',
);

